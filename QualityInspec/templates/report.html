<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>분석 결과</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
    th { background-color: #4CAF50; color: white; }
    tr:nth-child(even) { background-color: #f2f2f2; }
  </style>
</head>
<body>
  <h2>공정능력 분석 결과</h2>
  <div>제품코드: <strong>{{code}}</strong></div>
  <div>기간: <strong>{{start}} ~ {{end}}</strong></div>
  <hr>

  {% if msg %}
    <p style="color: red;">{{msg}}</p>
  {% else %}
    <table>
      <tr>
        <th>Spec</th><th>평균</th><th>표준편차</th><th>Cp</th><th>Cpk</th><th>히스토그램</th>
      </tr>
      {% for r in results %}
      <tr>
        <td>{{r.spec}}</td>
        <td>{{"%.3f"|format(r.mean)}}</td>
        <td>{{"%.3f"|format(r.std)}}</td>
        <td>{{"%.3f"|format(r.cp)}}</td>
        <td>{{"%.3f"|format(r.cpk)}}</td>
        <td><img src="data:image/png;base64,{{r.hist_img}}" style="height:80px; width:auto;"></td>
      </tr>
      {% endfor %}
    </table>

    <form action="/pdf" method="post" style="margin-top:20px;">
      <input type="hidden" name="code" value="{{code}}">
      <input type="hidden" name="start" value="{{start}}">
      <input type="hidden" name="end" value="{{end}}">
      <button type="submit" style="padding: 10px 20px; background-color: #4CAF50; color: white; border: none; cursor: pointer;">PDF 다운로드</button>
    </form>
  {% endif %}

  <p><a href="/" style="color: #4CAF50;">← 처음으로 돌아가기</a></p>
</body>
</html>
